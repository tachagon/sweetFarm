<% provide(:title, t('views.static_pages.index.title')) %>

<% if logged_in? %>

  <%= render partial: "index_logged_in", locals: {announcements: @announcements} %>

<% else %>

  <%= render partial: "index_not_logged_in" %>

<% end %>

<script type="text/javascript">

$(document).ready(function () {
  $('#per_page').on('change', function () {
    $('#form-perpage').submit();
  });
});

  // var old_data = {};
  // setInterval(function () {
  //   $.getJSON('/announcements.json', function (data) {
  //     if (JSON.stringify(old_data) === JSON.stringify(data)) {
  //       console.log('equal');
  //     } else {
  //       console.log('not equal');
  //       var html = "";
  //       for (var i = 0; i < data.length; i++) {
  //         var id = data[i]["id"];
  //         var role = data[i]["role"];
  //         var amount = data[i]["amount"];
  //         var price = data[i]["price"];
  //         var province_name = get_province(data[i].district_id).PROVINCE_NAME;
  //         var amphur_name = get_amphur(data[i].district_id).AMPHUR_NAME;
  //         var district_name = get_district(data[i].district_id).DISTRICT_NAME;

  //         html += card_announcement(id, role, amount, price, province_name, amphur_name, district_name);
  //       }
  //       document.getElementById("feed-announcements").innerHTML = html;
  //     }
  //     old_data = data;
  //   });
  // }, 1000);
</script>
